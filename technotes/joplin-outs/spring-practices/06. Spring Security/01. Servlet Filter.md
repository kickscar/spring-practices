01. Servlet Filter

### JavaEE 애플리케이션 보안과 Servlet Filter 

 세삼스럽지만, Spring은 JavaEE 애플리케이션 개발의 사실상 표준 프레임워크이다. 따라서 Spring Security도 JavaEE 개발의 사실상 "애플리케이션 레벨"의 표준 보안 프레임워크라 할 수 있다. 소프트웨어 시스템 보안은 여러 계층(layer)에서 개별적으로 다루어야만 하는 주제다. 예를 들면, 크게 인프라 계층과 시스템 계층으로 나누고 인프라 계층에 네트워크, 컴퓨팅, 운영체체(OS)로 각각의 레벨에서 보안 주제들을 다루어야 한다. 시스템 계층도 마찬가지다. 애플리케이션, 데이터베이스 등의 레벨에서 각각의 보안 주제들이 전문적이고 세분화된 주제로 다루어져야 하고 다시, 전 계층을 통합하여 복잡하게 다루는 것이 일반적이라 하겠다.
 
 Spring Security는 이 중에서 애플리케이션 레벨의 보안에만 집중한다. 애플리케이션에서 주로 다루게 되는 보안 주제는 인증(Authentication)과 권한(Authorization)이다. Spring Security는 이 주제에 대한 구현을 완벽히 지원한다. 거기에 한 가지 더, 웹 기반의 JavaEE 애플리케이션의 특성상 일반적인 웹 공격(OWASP, https://www.owasp.org)에 대한 대응도 완벽히 지원한다.
 
 Spring 기반의 JavaEE 애플리케이션에서는 그 실행과 환경 그리고 데이터 처리와 저장에 대한 대부분의 로직이 Spring Context 내의 Bean들로 구현된다. 따라서 Spring Security가 보호해야 할 대상은 Spring Context이며 더 구체적으로는 Spring Context가 관리하는 Bean들의 실행이다.

 Spring Context 내부의 Bean들의 실행은 클라이언트의 HTTP 요청(HttpServletRequest)과 매핑되어 있다. 그리고 JavaEE Servlet이 그 연결을 책임진다. Servlet의 HTTP 요청 처리과 관련된 설정은 WAS(Tomcat)의 Servlet Context에서 관리되는데 이 Servlet Context는 web.xml(Deployment Descriptor)에서 설정하고 WAS가 실행될 때 생성되고 구성된다. Spring에서는 Servlet Context에 DispatcherServlet만을 설정한다. 그리고 DispatcherServlet은 자신이 받은 요청이 매핑된 Spring Context 내부의 특정 Bean을 실행한다. 간단하게 요약했지만 이것이 Spring MVC(Web)의 핵심이다. 

 한편, Spring Context를 보호해야 하는 Spring Security는 Servlet Context의 DispatcherServlet이 처리하는 모든 요청들을 DispatcherServlet 보다 앞서 감시하고 보안 정책을 적용하게 된다. 이를 가능하게 해주는 기술이 Servlet Filter 이다. 보안이 간단치만은 않기 때문에 개별적인 보안 목적을 수행하는 다 수의 Filter들이 함께 순차적으로 감시하게 되며 보안 조건을 만족하게 되면 최종적으로는 Servlet 실행까지 책임. 이를 Filter Chain 이라 한다. Spring Security Architecture는 전적으로 Servlet Filter를 기반하고 있다.

 그럼, 왜? Servlet Security가 아니고 Spring Security 인가? 맞다. Servlet Filter는 이름대로 Servlet과 함께 Servlet Context에서 관리하는 컴포넌트다. 간단히 나올 질문이 아니기 때문에 대답 또한 그리 간단하게 할 수 없다. 대답을 하기 위해서는 Spring Security Architecture를 이해해야 한다. 이를 위해, 먼저 JavaEE 응용 패턴인 Intercepting Filter 패턴을 Servlet Filter및 Filter Chain과 함께 이해해야 한다. 그 다음에 Proxy 디자인 패턴을 기본으로 질문의 답인 Spring Security Architecture를 이해해야 한다.
 
### JavaEE Intercepting Filter Pattern



### Spring Security Architecture
 
